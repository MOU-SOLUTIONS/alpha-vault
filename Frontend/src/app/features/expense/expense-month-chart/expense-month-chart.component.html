<!-- ================================================================
              Coded by Mohamed Dhaoui for Alpha Vault
================================================================ -->

<div class="row" role="region" aria-labelledby="monthChartTitle">
  <div class="col-12">
    <div class="chart-box" [class.loading]="isLoading">
      <div class="chart-header">
        <h3 id="monthChartTitle" class="chart-title">Monthly Expense Overview</h3>
        <div class="chart-actions" *ngIf="!isLoading">
          <button class="toggle-btn" (click)="toggleChartType()" aria-label="Toggle chart type">
            <span class="toggle-icon">{{ isLineChart ? 'Bar' : 'Line' }}</span>
          </button>
          <button class="refresh-btn" (click)="refreshData()" aria-label="Refresh data">
            <i class="refresh-icon">â†»</i>
          </button>
        </div>
      </div>

      <div class="loading-indicator" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>Loading data...</p>
      </div>

      <div class="chart-container" [class.hidden]="isLoading">
        <canvas
          baseChart
          [data]="chartData"
          [options]="chartOptions"
          [type]="chartType"
          class="chart-canvas"
          role="img"
          aria-label="Monthly expense chart"
        ></canvas>
        <p class="no-data-message" *ngIf="!isLoading && (!chartData || chartData.datasets[0].data.length === 0)">
          No data available for this period
        </p>
      </div>

      <div class="chart-summary">
        <ng-container *ngIf="!isLoading && monthlyTotal > 0">
          <div class="summary-item">
            <span class="summary-label">Total</span>
            <span class="summary-value">{{ monthlyTotal | currency }}</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Average</span>
            <span class="summary-value">{{ monthlyAverage | currency }}</span>
          </div>
        </ng-container>
        
        <ng-container *ngIf="isLoading || monthlyTotal <= 0">
          <div class="summary-item">
            <span class="summary-label">Total</span>
            <span class="summary-value">--</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Average</span>
            <span class="summary-value">--</span>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>
