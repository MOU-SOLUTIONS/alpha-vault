<!--
  Alpha Vault Financial System
  
  @author Mohamed Dhaoui
  @component DebtDueDateChartComponent
  @description Main debt dashboard component template for managing debt payment deadlines
-->

<section class="due-date-chart-container" role="region" aria-labelledby="dueDateChartTitle">
  
  <header class="chart-header">
    <div class="header-content">
      <div class="header-icon" aria-label="Payment deadlines icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
          <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
          <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
          <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <div class="header-text">
        <h3 id="dueDateChartTitle" class="header-title">Payment Deadlines</h3>
        <p class="chart-subtitle">Track your upcoming debt payments</p>
      </div>
    </div>
  </header>
  
  <div class="chart-content">
    <div *ngIf="!hasDebtData" class="no-data">
      <div class="no-data-icon" aria-label="Chart icon">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
          <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
          <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
          <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
          <line x1="7" y1="14" x2="7" y2="18" stroke="currentColor" stroke-width="2"/>
          <line x1="11" y1="14" x2="11" y2="18" stroke="currentColor" stroke-width="2"/>
          <line x1="15" y1="14" x2="15" y2="18" stroke="currentColor" stroke-width="2"/>
        </svg>
      </div>
      <h3 class="no-data-title">No Debt Data Available</h3>
      <p class="no-data-description">Start adding your debts to see payment deadlines</p>
    </div>
    
    <div *ngIf="hasDebtData" class="due-date-list" role="list" aria-label="Debt payment deadlines">
      <div 
        *ngFor="let debt of sortedDebts; trackBy: trackByDebt; let i = index" 
        class="due-date-item"
        role="listitem"
        [attr.aria-label]="debt.creditorName + ' due date: ' + (debt.dueDate | date:'MMM dd, yyyy') + ', amount: $' + (debt.remainingAmount | number:'1.0-2')"
        [class]="getDebtStatus(debt.dueDate).class"
        [@slideInUp]="{ value: '*', params: { delay: i * 100 } }"
      >
        <div class="item-priority">
          <div class="priority-indicator" [class]="getDebtStatus(debt.dueDate).class"></div>
        </div>
        
        <div class="due-date-info">
          <div class="creditor-name">{{ debt.creditorName }}</div>
          <div class="due-date">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
              <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
              <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
              <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
            </svg>
            {{ debt.dueDate | date:'MMM dd, yyyy' }}
          </div>
        </div>
        
        <div class="debt-amount">
          <span class="amount-label">Amount</span>
          <span class="amount-value">${{ debt.remainingAmount | number:'1.0-2' }}</span>
        </div>
        
        <div class="status-section">
          <div class="status-badge" [class]="getDebtStatus(debt.dueDate).class" [attr.aria-label]="getDebtStatus(debt.dueDate).text">
            <span class="badge-icon" [attr.aria-hidden]="true">
              <svg *ngIf="getDebtStatus(debt.dueDate).iconType === 'overdue'" width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
              </svg>
              <svg *ngIf="getDebtStatus(debt.dueDate).iconType === 'urgent'" width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
              </svg>
              <svg *ngIf="getDebtStatus(debt.dueDate).iconType === 'warning'" width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L2 7l10 5 10-5-10-5z" fill="currentColor"/>
                <path d="M2 17l10 5 10-5" stroke="currentColor" stroke-width="2"/>
                <path d="M2 12l10 5 10-5" stroke="currentColor" stroke-width="2"/>
              </svg>
              <svg *ngIf="getDebtStatus(debt.dueDate).iconType === 'normal'" width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect x="3" y="4" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                <line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2"/>
                <line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2"/>
                <line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2"/>
              </svg>
            </span>
            {{ getDebtStatus(debt.dueDate).text }}
          </div>
          <div class="days-remaining" [class]="getDebtStatus(debt.dueDate).class" [attr.aria-label]="getDebtStatus(debt.dueDate).daysRemaining">
            {{ getDebtStatus(debt.dueDate).daysRemaining }}
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <footer class="chart-summary" *ngIf="hasDebtData" role="region" aria-label="Payment overview summary">
    <div class="summary-header">
      <h4>Payment Overview</h4>
      <div class="summary-total">
        <span class="total-label">Total Debts:</span>
        <span class="total-value">{{ debts.length }}</span>
      </div>
    </div>
    
    <div class="summary-grid" role="list" aria-label="Debt status counts">
      <div class="summary-item overdue" role="listitem" [attr.aria-label]="overdueCount + ' overdue debts'">
        <div class="summary-icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
            <polyline points="12,6 12,12 16,14" stroke="currentColor" stroke-width="2"/>
          </svg>
        </div>
        <div class="summary-content">
          <span class="summary-label">Overdue</span>
          <span class="summary-value">{{ overdueCount }}</span>
        </div>
      </div>
      
      <div class="summary-item urgent" role="listitem" [attr.aria-label]="urgentCount + ' debts due soon'">
        <div class="summary-icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="currentColor"/>
          </svg>
        </div>
        <div class="summary-content">
          <span class="summary-label">Due Soon</span>
          <span class="summary-value">{{ urgentCount }}</span>
        </div>
      </div>
      
      <div class="summary-item upcoming" role="listitem" [attr.aria-label]="upcomingCount + ' upcoming debts'">
        <div class="summary-icon" aria-hidden="true">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9 11H1v8a2 2 0 0 0 2 2h6v-10z" fill="currentColor"/>
            <path d="M23 11h-8v10h6a2 2 0 0 0 2-2v-8z" fill="currentColor"/>
            <path d="M13 1H1v8h12V1z" fill="currentColor"/>
            <path d="M23 1h-8v8h8V1z" fill="currentColor"/>
          </svg>
        </div>
        <div class="summary-content">
          <span class="summary-label">Upcoming</span>
          <span class="summary-value">{{ upcomingCount }}</span>
        </div>
      </div>
    </div>
  </footer>
</section>
